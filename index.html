<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cube and sphere on plane</title>

    <style type="text/css">
        body{
            margin:0;
            overflow: hidden;
        }
    </style>

    <script type="text/javascript" src="js/three.js"></script>
    <script type="text/javascript" src="js/jquery-3.0.0.js"></script>
    <script type="text/javascript" src="js/dat.gui.js"></script>

</head>
<body>
    <div id="output">

    </div>

    <script type="text/javascript">
        $(
            function () {

                var controls = new function () {
                    this.rotationSpeed = 0.02;
                    this.bouncingSpeed = 0.03;
                };

                var gui = new dat.gui.GUI();
                gui.add(controls, "rotationSpeed", 0, 0.5);
                gui.add(controls, "bouncingSpeed", 0, 0.5);

                //定义场景，保存并跟踪渲染的物体
                var scene = new THREE.Scene();
                //定义相机，定义了我们在scene中能够看到的
                var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);

                //定义渲染器
                //创建WebglRenderer对象，使用计算机上的显卡
                var renderer = new THREE.WebGLRenderer();
                renderer.setClearColor(0xEEEEEE, 1.0);
                renderer.setSize(window.innerWidth, window.innerHeight);
                //使用阴影
                renderer.shadowMapEnabled = true;

                //设置坐标轴
                var axes = new THREE.AxisHelper(20);
                scene.add(axes);

                //定义plane
                //定义对象的尺寸
                var planeGeometry = new THREE.PlaneGeometry(60, 20, 1, 1);
                //定义外观
                //使用基本的材质，MeshBasicMaterial
                //var planeMaterial = new THREE.MeshBasicMaterial({color : 0xCCCCCC});
                var planeMaterial = new THREE.MeshLambertMaterial({color : 0xCCCCCC});
                //创建网格Mesh对象
                var plane = new THREE.Mesh(planeGeometry, planeMaterial);

                //设定位置
                plane.rotation.x = - 0.5 * Math.PI;
                plane.position.x = 15;
                plane.position.y = 0;
                plane.position.z = 0;

                scene.add(plane);

                //定义cube
                //线框属性wireframe为true
                var cubeGeomertry = new THREE.CubeGeometry(4,4,4);
                //var cubeMaterial = new THREE.MeshBasicMaterial({color : 0xFF0000, wireframe : true});
                var cubeMaterial = new THREE.MeshLambertMaterial({color : 0xFF0000, wireframe : true});
                var cube = new THREE.Mesh(cubeGeomertry, cubeMaterial);

                cube.position.x = -4;
                cube.position.y = 3;
                cube.position.z = 0;

                scene.add(cube);

                //定义sphere
                var sphereGeometry = new THREE.SphereGeometry(4, 20, 20);
                //var sphereMaterial = new THREE.MeshBasicMaterial({color : 0x7777FF, wireframe : true});
                var sphereMaterial = new THREE.MeshLambertMaterial({color : 0x7777FF, wireframe : true});
                var sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);

                sphere.position.x = 20;
                sphere.position.y = 4;
                sphere.position.z = 2;

                scene.add(sphere);

                //添加灯光
                var spotLight = new THREE.SpotLight(0xFFFFFF);
                spotLight.position.set(-40, 60, -10);
                scene.add(spotLight);

                //设置投影
                spotLight.castShadow = true;
                plane.receiveShadow = true;
                cube.castShadow = true;
                sphere.castShadow = true;

                //设定相机的位置
                camera.position.x = -30;
                camera.position.y = 40;
                camera.position.z = 30;
                //使用LoookAt函数指向场景的中心
                camera.lookAt(scene.position);

                //将渲染器renderer输出到div#output中
                $("#output").append(renderer.domElement);
                renderScene();

                var step = 0;
                //循环渲染
                function renderScene() {
                    cube.rotation.x += controls.rotationSpeed;
                    cube.rotation.y += controls.rotationSpeed;
                    cube.rotation.z =+ controls.rotationSpeed;

                    step += controls.bouncingSpeed;
                    sphere.position.x = 20 + (10 * (Math.cos(step)));
                    sphere.position.y = 2 + (10 * Math.abs(Math.sin(step)));

                    requestAnimationFrame(renderScene);
                    renderer.render(scene, camera);
                }
            }
        );

    </script>

</body>
</html>